<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>IP…</title>

<script>
let lastIP = null;

async function updateIP() {
  try {
    const ipRes = await fetch("https://api.ipify.org?format=json");
    const { ip } = await ipRes.json();

    const infoRes = await fetch(`https://ipapi.co/${ip}/json/`);
    const info = await infoRes.json();

    const org = (info.org || "").toLowerCase();
    const asn = (info.asn || "").toLowerCase();

    const vpnIndicators = [
      "vpn", "hosting", "cloud", "digitalocean", "amazon",
      "aws", "ovh", "linode", "mullvad", "nord", "proton",
      "private internet access", "pia"
    ];

    const isVPN = vpnIndicators.some(v =>
      org.includes(v) || asn.includes(v)
    );

    const vpnStatus = isVPN ? "VPN" : "LOCAL";

    // Arc pinned tab prefers SHORT titles
    document.title = `${vpnStatus} • ${ip}`;

    document.getElementById("ip").textContent = ip;
    document.getElementById("vpn").textContent = vpnStatus;
    document.getElementById("org").textContent = info.org || "Unknown";
    document.getElementById("loc").textContent =
      `${info.city || ""} ${info.region || ""} ${info.country || ""}`;

    // Detect IP change
    if (lastIP && lastIP !== ip) {
      document.body.classList.add("changed");
    }
    lastIP = ip;

  } catch (e) {
    document.title = "IP unavailable";
  }
}

updateIP();
setInterval(updateIP, 20000); // 20s refresh
</script>

<style>
html, body {
  margin: 0;
  padding: 0;
  background: #000;
  color: #7dd3fc; /* light blue */
  font-family: system-ui, -apple-system, BlinkMacSystemFont;
}

body {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100vh;
}

.card {
  border: 1px solid #38bdf8;
  border-radius: 12px;
  padding: 24px 32px;
  text-align: center;
  box-shadow: 0 0 25px rgba(56,189,248,0.25);
}

h1 {
  font-size: 1.8rem;
  margin-bottom: 8px;
}

.status {
  font-size: 1.1rem;
  margin-bottom: 12px;
}

.meta {
  font-size: 0.9rem;
  opacity: 0.85;
}

.changed {
  animation: flash 0.5s ease-in-out 3;
}

@keyframes flash {
  0% { background: #000; }
  50% { background: #082f49; }
  100% { background: #000; }
}
</style>
</head>

<body>
  <div class="card">
    <h1 id="ip">Loading…</h1>
    <div class="status">
      Status: <strong id="vpn">—</strong>
    </div>
    <div class="meta">
      <div id="org"></div>
      <div id="loc"></div>
    </div>
  </div>
</body>
</html>
