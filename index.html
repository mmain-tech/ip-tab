<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Loading IP…</title>
<script>
async function updateIP() {
  try {
    // Get public IP
    const ipRes = await fetch("https://api.ipify.org?format=json");
    const { ip } = await ipRes.json();

    // Get org/provider and location
    const infoRes = await fetch(`https://ipwhois.app/json/${ip}?lang=en`);
    const info = await infoRes.json();

    // Determine tab prefix
    let tabPrefix = "[o]"; // default
    if (ip === "23.121.154.100" && info.city === "Hercules" && info.region === "CA") {
      tabPrefix = "[x]"; // special case
    }

    // Update tab title
    document.title = `${tabPrefix} ${ip}`;

    // Update page content
    document.getElementById("ip").textContent = ip;
    document.getElementById("org").textContent = "Provider: " + (info.org || "Unknown");
    document.getElementById("loc").textContent =
      "Location: " + [info.city, info.region, info.country].filter(Boolean).join(", ");

  } catch (e) {
    document.title = "IP unavailable";
    document.getElementById("ip").textContent = "IP unavailable";
    document.getElementById("org").textContent = "Provider: -";
    document.getElementById("loc").textContent = "Location: -";
    console.error("Failed to fetch IP info:", e);
  }
}

// Initial load
updateIP();

// Refresh every 30 seconds
setInterval(updateIP, 30000);
</script>

<style>
html, body {
  margin: 0;
  padding: 0;
  background: #000;
  color: #7dd3fc; /* light blue */
  font-family: system-ui, -apple-system, BlinkMacSystemFont;
}

body {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100vh;
}

.card {
  border: 1px solid #38bdf8;
  border-radius: 12px;
  padding: 24px 32px;
  text-align: center;
  box-shadow: 0 0 25px rgba(56,189,248,0.25);
}

h1 {
  font-size: 2rem;
  margin-bottom: 8px;
}

.meta {
  font-size: 0.95rem;
  opacity: 0.85;
}
</style>
</head>
<body>
  <div class="card">
    <h1 id="ip">Loading…</h1>
    <div class="meta" id="org">Provider: -</div>
    <div class="meta" id="loc">Location: -</div>
  </div>
</body>
</html>
